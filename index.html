<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	
	<title>Gifs</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style type="text/css">
	.btn {
		margin:5px;
		padding:5px 40px 5px 40px;
	}

	#animals-form {
		margin-left: 10px;
	}
</style>

</head>
<body>

<div id="buttonArea"></div>
<br/>
<form id="animals-form">
      <label for="animal-input">Add an animal</label><br/>
      <input type="text" id="animal-input"><br>
      <input id="add-animal" type="submit" value="Add">
    </form>
<div id="gif-area"></div>


<script type="text/javascript">
 var animals = ["dog", "cat", "pig", "cow", "sloth"]


//function that generates buttons from array onto the first line
function buttonGenerator(){
	$("#buttonArea").empty();
	for (var i =0; i < animals.length; i++){
		var a = $("<button>");
		a.addClass("btn");
		a.attr("value", animals[i]);
		a.text(animals[i]);
		$("#buttonArea").append(a);
	}
}

//adding new buttons from form
$("#add-animal").on("click",function (event){
	event.preventDefault();
	var animal = $("#animal-input").val().trim();
	animals.push(animal);
	buttonGenerator()
});

//function that generates gifs with rating
function displayGif(){
	var animal = $(this).val();
	var queryURL = "http://api.giphy.com/v1/gifs/search?q="+animal+"&api_key=dc6zaTOxFJmzC&limit=10";

	$.ajax({
		url:queryURL,
		method: "GET"
	})
	.done(function(response){
		console.log(response);
		var results = response.data;
		for (var i = 0; i < results.length; i++){
			var gifDiv = $("<div>");

			var rating = results[i].rating;
			var p = $("<p>").text("Rating: "+ rating);
			var gif = $("<img>");

			gif.addClass("gif")
			gif.attr("data-state","still");
			gif.attr("src", results[i].images.fixed_height_still.url);
			gif.attr("data-still", results[i].images.fixed_height_still.url);
			gif.attr("data-animate", results[i].images.fixed_height.url);

			gifDiv.append(p,gif);
			$("#gif-area").prepend(gifDiv);


		}
	})
}



//click listener on buttons to generate gifs
$(document).on("click", ".btn",
	displayGif);

//generates initial buttons
buttonGenerator();


//click listener on gifs to animate and still
$("#gif-area").on("click", ".gif", function() {

        var state = $(this).attr("data-state");
        console.log(state);

        if (state === "still") {
          var dataAnimate = $(this).attr("data-animate");
          $(this).attr("src",dataAnimate);
          $(this).attr("data-state","animate");
        }
          else {
          var dataStill = $(this).attr("data-still");
          $(this).attr("src",dataStill);
          $(this).attr("data-state","still");
          }
    });
</script>

	
</body>
</html>